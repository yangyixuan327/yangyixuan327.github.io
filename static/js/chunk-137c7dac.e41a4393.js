(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-137c7dac"],{"5b5f":function(e,a,t){"use strict";t.r(a);var i=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"app-container"},[t("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"primary"},on:{click:e.onCreateNewClicked}},[e._v("新建 "),t("i",{staticClass:"el-icon-plus el-icon--right"})]),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.list,"span-method":e.rowSpanMethod,"element-loading-text":"Loading",border:"",fit:""}},[t("el-table-column",{attrs:{align:"center",label:"病例ID",width:"95"},scopedSlots:e._u([{key:"default",fn:function(a){return[e._v(" "+e._s(a.row.caseId)+" ")]}}])}),t("el-table-column",{attrs:{label:"病例名称"},scopedSlots:e._u([{key:"default",fn:function(a){return[e._v(" "+e._s(a.row.caseName)+" ")]}}])}),t("el-table-column",{attrs:{label:"接诊"},scopedSlots:e._u([{key:"default",fn:function(a){return["words"===a.row.type?t("span",[e._v(e._s(a.row.jieZhen))]):e._e(),"image"===a.row.type?t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onImageClicked(a.row.caseId,a.row.jieZhen)}}},[e._v("图片")]):e._e(),"video"===a.row.type?t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onVideoClicked(a.row.caseId,a.row.jieZhen)}}},[e._v("视频")]):e._e()]}}])}),t("el-table-column",{attrs:{label:"诊断方案"},scopedSlots:e._u([{key:"default",fn:function(a){return["words"===a.row.type?t("span",[e._v(e._s(a.row.zhenDuan))]):e._e(),"image"===a.row.type?t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onImageClicked(a.row.caseId,a.row.zhenDuan)}}},[e._v("图片")]):e._e(),"video"===a.row.type?t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onVideoClicked(a.row.caseId,a.row.zhenDuan)}}},[e._v("视频")]):e._e()]}}])}),t("el-table-column",{attrs:{label:"治疗方案"},scopedSlots:e._u([{key:"default",fn:function(a){return["words"===a.row.type?t("span",[e._v(e._s(a.row.zhiLiao))]):e._e(),"image"===a.row.type?t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onImageClicked(a.row.caseId,a.row.zhiLiao)}}},[e._v("图片")]):e._e(),"video"===a.row.type?t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onVideoClicked(a.row.caseId,a.row.zhiLiao)}}},[e._v("视频")]):e._e()]}}])}),t("el-table-column",{attrs:{align:"center",prop:"created_at",label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button-group",[t("el-button",{attrs:{type:"primary",icon:"el-icon-edit"},on:{click:function(t){return e.onEditClicked(a.row.caseId,a.$index)}}}),t("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(t){return e.onDeleteClicked(a.row.caseId,a.$index)}}})],1)]}}])})],1),t("el-dialog",{attrs:{visible:e.wordsDialog.visible,title:e.wordsDialog.title,width:"50%",center:"","destroy-on-close":""},on:{close:function(a){e.wordsDialog.visible=!1}},scopedSlots:e._u([{key:"footer",fn:function(){return[t("span",{staticClass:"dialog-footer"},[t("el-button",{on:{click:function(a){e.wordsDialog.visible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.wordsDialogConfirmOnClicked}},[e._v("确 定")])],1)]},proxy:!0}])},[t("el-form",{attrs:{model:e.form}},[t("el-form-item",{attrs:{label:"病例名称","label-width":"120px"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.caseName,callback:function(a){e.$set(e.form,"caseName",a)},expression:"form.caseName"}})],1),t("el-form-item",{attrs:{label:"接诊文字A","label-width":"120px"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.jieZhen,callback:function(a){e.$set(e.form,"jieZhen",a)},expression:"form.jieZhen"}})],1),t("el-form-item",{attrs:{label:"诊断文字A","label-width":"120px"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.zhenDuan,callback:function(a){e.$set(e.form,"zhenDuan",a)},expression:"form.zhenDuan"}})],1),t("el-form-item",{attrs:{label:"治疗文字A","label-width":"120px"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.zhiLiao,callback:function(a){e.$set(e.form,"zhiLiao",a)},expression:"form.zhiLiao"}})],1)],1)],1),t("el-dialog",{attrs:{visible:e.mediaDialog.visible,title:e.mediaDialog.title,width:"50%",center:"","destroy-on-close":""},on:{close:function(a){e.mediaDialog.visible=!1}},scopedSlots:e._u([{key:"footer",fn:function(){return[t("span",{staticClass:"dialog-footer"},[t("el-button",{on:{click:function(a){e.mediaDialog.visible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(a){e.mediaDialog.visible=!1}}},[e._v("确 定")])],1)]},proxy:!0}])},[e.mediaDialog.imageVisible?t("div",{staticClass:"case-image",staticStyle:{width:"90%",height:"90%",margin:"0 auto"}},e._l(e.imageUrls,(function(a){return t("el-image",{key:a,attrs:{src:a,lazy:""},scopedSlots:e._u([{key:"error",fn:function(){return[t("div",{staticClass:"image-slot"},[t("i",{staticClass:"el-icon-picture-outline"})])]},proxy:!0}],null,!0)})})),1):e._e(),e.mediaDialog.videoVisible?t("div",{staticClass:"case-video",staticStyle:{width:"90%",height:"90%",margin:"0 auto"}},[""!==e.videoUrl?t("video",{staticStyle:{width:"100%",height:"100%"},attrs:{src:e.videoUrl,controls:"controls"}}):e._e()]):e._e(),t("el-upload",{staticClass:"media-upload",attrs:{action:e.postUrl,name:e.uploadParamName,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"on-success":e.handleUploadSuccess,"before-upload":e.handleBeforeUpload,multiple:"",limit:1,"on-exceed":e.handleExceed,"file-list":e.fileList},scopedSlots:e._u([{key:"tip",fn:function(){return[t("div",{staticClass:"el-upload__tip"},[e._v(" "+e._s(e.uploadTip)+" ")])]},proxy:!0}])},[t("el-button",{staticStyle:{"margin-left":"auto","margin-top":"40px"},attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1)],1)],1)},o=[],n=(t("a434"),t("99af"),t("d4f4")),s={data:function(){return{list:null,listLoading:!0,wordsDialog:{visible:!1,title:"",changeMode:"add"},mediaDialog:{visible:!1,imageVisible:!1,videoVisible:!1,title:""},form:{caseId:-1,caseIndex:-1,caseName:"",jieZhen:"",zhenDuan:"",zhiLiao:""},imageUrls:[],videoUrl:"",postUrl:"",uploadTip:"",uploadParamName:"image",fileList:[]}},created:function(){this.fetchData()},methods:{fetchData:function(){var e=this;this.listLoading=!0,Object(n["d"])().then((function(a){console.log(a.data.responseMap);var t=a.data.responseMap.result,i=a.data.responseMap.descrip,o=a.data.responseMap.count;console.log("item count: "+o);for(var n=[],s=0;s<t.length;s++){var l=t[s];n.push({caseId:l.caseId,type:"words",caseName:l.caseName,jieZhen:i[s][0],zhenDuan:i[s][1],zhiLiao:i[s][2]}),n.push({caseId:l.caseId,type:"image",caseName:l.caseName,jieZhen:"jieZhen",zhenDuan:"zhenDuan",zhiLiao:"zhiLiao"}),n.push({caseId:l.caseId,type:"video",caseName:l.caseName,jieZhen:"jieZhen",zhenDuan:"zhenDuan",zhiLiao:"zhiLiao"})}e.list=n,e.listLoading=!1}))},rowSpanMethod:function(e){e.row,e.column;var a=e.rowIndex,t=e.columnIndex;if(0===t||1===t||5===t)return a%3===0?{rowspan:3,colspan:1}:{rowspan:0,colspan:0}},onDeleteClicked:function(e,a){var t=this;this.$confirm("是否删除？","删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(n["c"])(e).then((function(e){console.log(e.data),200===e.data.status?(t.$message("删除成功"),t.list.splice(a,3)):t.$message("删除失败 请重试")}))})).catch((function(){t.$message("取消删除")}))},onCreateNewClicked:function(){this.wordsDialog.visible=!0,this.wordsDialog.title="创建病例",this.form.caseName="",this.form.jieZhen="",this.form.zhenDuan="",this.form.zhiLiao="",this.wordsDialog.changeMode="add"},onEditClicked:function(e,a){this.wordsDialog.title="编辑病例",this.form.caseId=e,this.form.caseIndex=a,this.form.caseName=this.list[a].caseName,this.form.jieZhen=this.list[a].jieZhen,this.form.zhenDuan=this.list[a].zhenDuan,this.form.zhiLiao=this.list[a].zhiLiao,this.wordsDialog.visible=!0,this.wordsDialog.changeMode="update"},wordsDialogConfirmOnClicked:function(){var e=this;this.wordsDialog.visible=!1;var a={caseId:this.form.caseId,caseIndex:this.form.caseIndex,caseName:this.form.caseName,jieZhen:this.form.jieZhen,zhenDuan:this.form.zhenDuan,zhiLiao:this.form.zhiLiao,changeMode:this.wordsDialog.changeMode};"add"===a.changeMode?Object(n["a"])(a).then((function(t){console.log(t),200===t.data.status?(a.caseId=t.data.responseMap.result,console.log(a.caseId),Object(n["b"])(a).then(e.$axios.spread((function(t,i,o){200===t.data.status&&200===i.data.status&&200===o.data.status?(e.$message("添加成功"),e.list.push({caseId:a.caseId,type:"words",caseName:e.form.caseName,jieZhen:e.form.jieZhen,zhenDuan:e.form.zhenDuan,zhiLiao:e.form.zhiLiao},{caseId:a.caseId,type:"image",caseName:e.form.caseName,jieZhen:"jieZhen",zhenDuan:"zhenDuan",zhiLiao:"zhiLiao"},{caseId:a.caseId,type:"video",caseName:e.form.caseName,jieZhen:"jieZhen",zhenDuan:"zhenDuan",zhiLiao:"zhiLiao"})):(console.log(t,i,o),e.$message("病例文字信息添加失败 请重试"))})))):e.$message("病例添加失败 请重试"),e.wordsDialog.visible=!1})):"update"===a.changeMode&&Object(n["f"])(a).then(e.$axios.spread((function(t,i){var o=a.caseIndex;200===t.data.status&&200===i.data.status?(e.$message("更新成功"),null!=o&&o>=0?(e.list[o].caseName=e.form.caseName,e.list[o].jieZhen=e.form.jieZhen,e.list[o].zhenDuan=e.form.zhenDuan,e.list[o].zhiLiao=e.form.zhiLiao):e.$message("无法更新本地信息 请刷新")):200!==t.data.status?(console.log("name update fail"),console.log(t),e.$message("病例名更新失败 请重试")):200!==i.data.status&&(console.log("desc update fail"),console.log(i),e.$message("病例信息更新失败 请重试")),e.wordsDialog.visible=!1})))},onImageClicked:function(e,a){var t=this;this.mediaDialog.visible=!0,this.mediaDialog.imageVisible=!0,this.mediaDialog.videoVisible=!1,this.mediaDialog.title="病例图片",this.uploadTip="上传图片please",this.uploadParamName="image";var i="http://59.110.174.202:8080";"jieZhen"===a?this.postUrl=i+"/admin/case/"+e+"/consult/image":"zhenDuan"===a?this.postUrl=i+"/admin/case/"+e+"/diag/image":"zhiLiao"===a&&(this.postUrl=i+"/admin/case/"+e+"/therapy/image"),Object(n["e"])(e,a).then((function(e){console.log(e);var i="";"jieZhen"===a?i=e.data.responseMap.result.consultImageUrl:"zhenDuan"===a?i=e.data.responseMap.result.diagImageUrl:"zhiLiao"===a&&(i=e.data.responseMap.result.therapyImageUrl),"NULL"!==i&&(i="http://"+i),console.log(i),t.imageUrls=[i]}))},onVideoClicked:function(e,a){var t=this;this.mediaDialog.visible=!0,this.mediaDialog.imageVisible=!1,this.mediaDialog.videoVisible=!0,this.mediaDialog.title="病例视频",this.uploadTip="上传mp4格式please，100M以内",this.uploadParamName="video";var i="http://59.110.174.202:8080";console.log("type: "+a),"jieZhen"===a?this.postUrl=i+"/admin/case/"+e+"/consult/video":"zhenDuan"===a?this.postUrl=i+"/admin/case/"+e+"/diag/video":"zhiLiao"===a&&(this.postUrl=i+"/admin/case/"+e+"/therapy/video"),Object(n["e"])(e,a).then((function(e){console.log("video response:",e);var i="";"jieZhen"===a?i=e.data.responseMap.result.consultVideoUrl:"zhenDuan"===a?i=e.data.responseMap.result.diagVideoUrl:"zhiLiao"===a&&(i=e.data.responseMap.result.therapyVideoUrl),t.videoUrl="NULL"!==i?"http://"+i:"",console.log("videoUrl: "+t.videoUrl),console.log("postUrl: "+t.postUrl)}))},handleRemove:function(e,a){console.log(e,a)},handlePreview:function(e){console.log(e)},handleExceed:function(e,a){this.$message.warning("当前限制选择 3 个文件，本次选择了 ".concat(e.length," 个文件，共选择了 ").concat(e.length+a.length," 个文件"))},handleUploadSuccess:function(e,a){var t=e.responseMap.result;null!==t?(t="http://"+t,console.log(t),this.videoUrl=t,this.imageUrls=[t]):(this.videoUrl="",this.imageUrls=[])},handleBeforeUpload:function(e){var a=e.size/1024/1024;if(a>100)return this.$alert("文件大小不能超过100M"),!1}}},l=s,r=t("2877"),c=Object(r["a"])(l,i,o,!1,null,null,null);a["default"]=c.exports},a434:function(e,a,t){"use strict";var i=t("23e7"),o=t("23cb"),n=t("a691"),s=t("50c4"),l=t("7b0b"),r=t("65f0"),c=t("8418"),d=t("1dde"),u=t("ae40"),h=d("splice"),m=u("splice",{ACCESSORS:!0,0:0,1:2}),p=Math.max,f=Math.min,g=9007199254740991,v="Maximum allowed length exceeded";i({target:"Array",proto:!0,forced:!h||!m},{splice:function(e,a){var t,i,d,u,h,m,b=l(this),w=s(b.length),D=o(e,w),y=arguments.length;if(0===y?t=i=0:1===y?(t=0,i=w-D):(t=y-2,i=f(p(n(a),0),w-D)),w+t-i>g)throw TypeError(v);for(d=r(b,i),u=0;u<i;u++)h=D+u,h in b&&c(d,u,b[h]);if(d.length=i,t<i){for(u=D;u<w-i;u++)h=u+i,m=u+t,h in b?b[m]=b[h]:delete b[m];for(u=w;u>w-i+t;u--)delete b[u-1]}else if(t>i)for(u=w-i;u>D;u--)h=u+i-1,m=u+t-1,h in b?b[m]=b[h]:delete b[m];for(u=0;u<t;u++)b[u+D]=arguments[u+2];return b.length=w-i+t,d}})},d4f4:function(e,a,t){"use strict";t.d(a,"d",(function(){return s})),t.d(a,"c",(function(){return l})),t.d(a,"e",(function(){return r})),t.d(a,"f",(function(){return c})),t.d(a,"a",(function(){return d})),t.d(a,"b",(function(){return u}));var i=t("2fff"),o=t("bc3a"),n=t.n(o);function s(){return Object(i["a"])({url:"/admin/case",method:"get"})}function l(e){var a={caseId:e};return Object(i["a"])({url:"/admin/case",method:"delete",params:a})}function r(e,a){var t="/admin/case/"+e+"/";return"jieZhen"===a?t+="consult":"zhenDuan"===a?t+="diag":"zhiLiao"===a&&(t+="therapy"),Object(i["a"])({url:t,method:"get"})}function c(e){var a=e.caseId,t="/admin/case/",o=Object(i["a"])({url:t+a,method:"post",params:{caseName:e.caseName}}),s=Object(i["a"])({url:t+a+"/descrip",method:"post",data:{consultDescrip:e.jieZhen,diagDescrip:e.zhenDuan,therapyDescrip:e.zhiLiao}});return n.a.all([o,s])}function d(e){return Object(i["a"])({url:"/admin/case",method:"put",params:{caseName:e.caseName}})}function u(e){var a=e.caseId,t="/admin/case/",o=Object(i["a"])({url:t+a+"/consult",method:"put",params:{descrip:e.jieZhen}}),s=Object(i["a"])({url:t+a+"/diag",method:"put",params:{descrip:e.zhenDuan}}),l=Object(i["a"])({url:t+a+"/therapy",method:"put",params:{descrip:e.zhiLiao}});return n.a.all([o,s,l])}}}]);