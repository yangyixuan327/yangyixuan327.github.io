(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-022a74b2"],{3394:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("el-container",[s("el-aside",{staticStyle:{"text-align":"center"}},[s("el-card",{staticStyle:{"margin-top":"50px",height:"390px","text-align":"center"},attrs:{shadow:"hover"}},[s("div",{staticStyle:{position:"relative","text-align":"center"}},[s("p",{staticStyle:{"text-align":"center",color:"darkred","font-size":"20px","margin-top":"50px"}},[s("b",[t._v("剩余时间")])]),s("el-progress",{staticStyle:{position:"absolute",top:"110px",left:"70px"},attrs:{type:"circle",percentage:t.timeLeftPercentage,"show-text":!1}},[[s("span",[t._v("当前进度")])]],2),s("p",{staticStyle:{position:"absolute",top:"148px",left:"100px","text-align":"center"}},[t._v(t._s(t.timeLeft))])],1)])],1),s("el-container",[s("el-header",{staticStyle:{"margin-top":"50px","font-size":"40px","text-align":"center"}},[s("el-card",{attrs:{shadow:"always"}},[s("b",[t._v(t._s(t.paperName))])])],1),s("el-main",[s("el-card",{staticStyle:{height:"300px","margin-top":"10px"},attrs:{shadow:"hover"},scopedSlots:t._u([{key:"header",fn:function(){return[s("div",{staticStyle:{"text-align":"center"}},[s("span",[t._v("第 "+t._s(t.questionIndex+1)+" 题 ("+t._s(t.tests[t.questionIndex].score)+" 分)")])])]},proxy:!0}])},[s("p",[t._v(t._s(t.tests[t.questionIndex].title))]),"select"===t.tests[t.questionIndex].type?s("div",{staticStyle:{"text-align":"center",height:"40px"}},[s("el-radio-group",{model:{value:t.tests[t.questionIndex].answer,callback:function(e){t.$set(t.tests[t.questionIndex],"answer",e)},expression:"tests[questionIndex].answer"}},t._l(t.choiceOption,(function(e,i){return s("el-radio",{key:i,attrs:{label:i}},[t._v(t._s(e))])})),1)],1):"judge"===t.tests[t.questionIndex].type?s("div",{staticStyle:{"text-align":"center",height:"40px"}},[s("el-radio-group",{model:{value:t.tests[t.questionIndex].answer,callback:function(e){t.$set(t.tests[t.questionIndex],"answer",e)},expression:"tests[questionIndex].answer"}},t._l(t.judgeOption,(function(e,i){return s("el-radio",{key:i,attrs:{label:i}},[t._v(t._s(e))])})),1)],1):"qa"===t.tests[t.questionIndex].type?s("div",{staticStyle:{height:"70px"}},[s("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入你的回答"},model:{value:t.tests[t.questionIndex].answer,callback:function(e){t.$set(t.tests[t.questionIndex],"answer",e)},expression:"tests[questionIndex].answer"}})],1):t._e(),s("div",{staticStyle:{"text-align":"center"}},[s("el-button-group",[s("el-button",{attrs:{type:"primary",icon:"el-icon-arrow-left",disabled:t.isPreDisabled},on:{click:t.onPreQuestionClicked}},[t._v("上一题")]),s("el-button",{attrs:{type:"primary",disabled:t.isNextDisabled},on:{click:t.onNextQuestionClicked}},[t._v("下一题"),s("i",{staticClass:"el-icon-arrow-right el-icon--right"})])],1)],1)])],1)],1)],1),s("el-card",{attrs:{shadow:"hover"}},[s("el-steps",{attrs:{active:t.questionIndex}},t._l(t.tests,(function(e,i){return s("el-step",{key:i,attrs:{label:i},nativeOn:{click:function(s){return t.onQuesClicked(e)}}})})),1)],1),s("div",{staticStyle:{"margin-top":"30px","margin-bottom":"20px"},attrs:{align:"center"}},[s("el-button",{attrs:{type:"primary",icon:"el-icon-check"},on:{click:t.onSubmitClicked}},[t._v("提交试卷")])],1),s("el-dialog",{attrs:{visible:t.submitAnswerDialog.visible,title:t.submitAnswerDialog.title,width:"50%",center:""},on:{close:function(e){t.submitAnswerDialog.visible=!1}},scopedSlots:t._u([{key:"footer",fn:function(){return[s("span",{staticClass:"dialog-footer"},[s("el-button",{on:{click:function(e){t.submitAnswerDialog.visible=!1}}},[t._v("取消")]),s("el-button",{attrs:{type:"primary"},on:{click:t.submitAnswerDialogConfirmOnClicked}},[t._v("确 定")])],1)]},proxy:!0}])},[s("div",{staticStyle:{margin:"0 auto","text-align":"center"}},[s("span",[t._v("确认提交？"),s("br"),t._v("该操作不可回退！")])])]),s("el-dialog",{attrs:{visible:t.showScoreDialog.visible,title:t.showScoreDialog.title,width:"50%",center:""},on:{close:t.showScoreDialogConfirmOnClicked},scopedSlots:t._u([{key:"footer",fn:function(){return[s("span",{staticClass:"dialog-footer"},[s("el-button",{attrs:{type:"primary"},on:{click:t.showScoreDialogConfirmOnClicked}},[t._v("查 看 结 果")])],1)]},proxy:!0}])},[s("div",{staticStyle:{margin:"0 auto","text-align":"center"}},[s("span",[t._v("提交成功！"),s("br"),t._v("请前往查看结果页面查看成绩")])])])],1)},n=[],o=(s("d3b7"),s("25f0"),s("84eb")),r=s("4360");function a(t){return new Promise((function(e){return setTimeout(e,t)}))}var u={data:function(){return{isErrorIn:!0,interval:setInterval(null,null,null),tests:null,secondsLeftTotal:0,timeLeftPercentage:100,haveDoneQuestionNumber:1,timeLeft:"00:00:00",duration:0,hourLeft:1,minuteLeft:1,secondLeft:0,startTime:"",questionIndex:0,judgeOption:["True","False"],choiceOption:["A","B","C","D"],submitAnswerDialog:{visible:!1,title:""},testId:-1,testOptionId:-1,paperId:-1,isPreDisabled:!1,isNextDisabled:!1,isRandom:!1,paperName:"",userId:r["a"].getters.token,showScoreDialog:{visible:!1,title:""},resultScore:0,isMidPointSubmitted:!1}},created:function(){this.testOptionId=this.$route.query.id,this.duration=this.$route.query.duration,this.startTime=this.$route.query.startTime,this.isPreDisabled=!0,this.setTimeLeft(),this.fetchData()},mounted:function(){var t=this;a(1500).then((function(){!1===t.isErrorIn&&(window.history&&window.history.pushState&&(history.pushState(null,null,document.URL),window.addEventListener("popstate",t.back,!1)),window.addEventListener("beforeunload",t.refresh))}))},destroyed:function(){window.removeEventListener("popstate",this.back,!1),window.removeEventListener("beforeunload",this.refresh),clearInterval(this.interval)},methods:{fetchData:function(){var t=this;Object(o["e"])(this.testOptionId).then((function(e){t.paperName=e.data.responseMap.result.testOptionName;var s=e.data.responseMap.result.selectNum+e.data.responseMap.result.judgeNum+e.data.responseMap.result.qaNum;t.isRandom=0!==s,Object(o["b"])(e.data.responseMap.result.testOptionId).then((function(e){var s=e.data.responseMap.result.length;t.paperId=e.data.responseMap.result[s-1].examId,console.log(t.paperId),Object(o["d"])(t.testOptionId,t.userId).then((function(e){400===e.data.status?(t.isErrorIn=!0,t.$message("你已经进行过该考试！请更换考试！")):200===e.data.status?(t.isErrorIn=!1,t.testId=e.data.responseMap.testId,Object(o["c"])(t.paperId).then((function(e){for(var s=e.data.responseMap.result,i=[],n=[],o=function(t){if(n.some((function(e){return e===s[t].quesId})))return"continue";i.push({id:null!=s[t].quesId?s[t].quesId:0,title:null!=s[t].descrip?s[t].descrip:"",type:null!=s[t].type?s[t].type:"",score:null!=s[t].score?s[t].score:"",tag:null!=s[t].tag?s[t].tag:"",image:"",answer:"",quesIndex:t}),n.push(s[t].quesId)},r=0;r<s.length;r++)o(r);t.tests=i,1===t.tests.length&&(t.isPreDisabled=!0,t.isNextDisabled=!0)}))):500===e.data.status&&(t.isErrorIn=!0,t.$message("考试时间已结束或未到考试时间！"))}))}))}))},onQuesClicked:function(t){this.tests.length-1===t.quesIndex&&0!==this.questionIndex?this.isNextDisabled=!0:0===t.quesIndex&&this.questionIndex!==this.tests.length-1?this.isPreDisabled=!0:this.tests.length-1===t.quesIndex&&0===this.questionIndex?(this.isNextDisabled=!0,this.isPreDisabled=!1):0===t.quesIndex&&this.questionIndex===this.tests.length-1?(this.isPreDisabled=!0,this.isNextDisabled=!1):1===this.tests.length?(this.isPreDisabled=!0,this.isNextDisabled=!0):0!==t.quesIndex&&t.quesIndex!==this.tests.length&&(this.isNextDisabled=!1,this.isPreDisabled=!1),this.questionIndex=t.quesIndex},setTimeLeft:function(){var t=this;this.hourLeft=Math.floor(this.duration/60),this.minuteLeft=Math.floor(this.duration%60),this.secondsLeftTotal=3600*this.hourLeft+60*this.minuteLeft+this.secondLeft,this.timeLeftPercentage=this.secondsLeftTotal/60/this.duration*100;var e=this.hourLeft<10?"0"+this.hourLeft:this.hourLeft,s=this.minuteLeft<10?"0"+this.minuteLeft:this.minuteLeft,i=this.secondLeft<10?"0"+this.secondLeft:this.secondLeft;this.timeLeft=e+":"+s+":"+i,this.interval=setInterval((function(){0===t.secondLeft?0===t.minuteLeft?0===t.hourLeft?(clearInterval(t.interval),t.$alert("已自动为您交卷！","考试时间结束",{confirmButtonText:"确定",callback:function(e){t.isMidPointSubmitted=!0,t.submitAnswerDialogConfirmOnClicked(),t.$router.push("/test_user/take_test")}})):(t.hourLeft-=1,t.minuteLeft=59,t.secondLeft=59):(t.minuteLeft-=1,t.secondLeft=59):t.secondLeft-=1,t.secondsLeftTotal=3600*t.hourLeft+60*t.minuteLeft+t.secondLeft,t.timeLeftPercentage=t.secondsLeftTotal/60/t.duration*100,e=t.hourLeft<10?"0"+t.hourLeft:t.hourLeft,s=t.minuteLeft<10?"0"+t.minuteLeft:t.minuteLeft,i=t.secondLeft<10?"0"+t.secondLeft:t.secondLeft,t.timeLeft=e+":"+s+":"+i}),1e3)},onPreQuestionClicked:function(){this.questionIndex=this.questionIndex-1,this.isNextDisabled=!1,0===this.questionIndex&&(this.isPreDisabled=!0)},onNextQuestionClicked:function(){this.questionIndex=this.questionIndex+1,this.isPreDisabled=!1,this.questionIndex===this.tests.length-1&&(this.isNextDisabled=!0)},back:function(){var t=this;this.$confirm("试卷尚未提交，退出页面将视作提交试卷答案！是否确认退出？","注意",{showClose:!1,confirmButtonText:"继续答题",cancelButtonText:"确认离开"}).then((function(){window.history&&window.history.pushState&&(history.pushState(null,null,document.URL),window.addEventListener("popstate",t.back,!1))})).catch((function(){t.isMidPointSubmitted=!0,t.submitAnswerDialogConfirmOnClicked(),t.$router.push("/test_user/take_test")}))},refresh:function(t){var e=this;if(t=t||window.event,t){t.returnValue="关闭提示";var s={testId:this.testId};Object(o["a"])(s).then((function(t){clearInterval(e.interval)}))}return"关闭"},onSubmitClicked:function(){this.submitAnswerDialog.title="提示",this.submitAnswerDialog.visible=!0},submitAnswerDialogConfirmOnClicked:function(){for(var t=this,e=[],s=this.tests,i=-1,n=-1,r="",a="",u=0;u<s.length;u++)i=s[u].id,e.push(i.toString()),n=s[u].answer,a=s[u].type,r="select"===a?0===n?"A":1===n?"B":2===n?"C":3===n?"D":"":"judge"===a?0===n?"1":1===n?"0":"-1":"qa"===a?s[u].answer:"",e.push(r);Object(o["g"])(this.testId,e).then((function(e){var s=e.data.responseMap.result;"200"===e.data.status&&(t.resultScore=s)})),clearInterval(this.interval),this.submitAnswerDialog.visible=!1,!1===this.isMidPointSubmitted?this.showScoreDialog.visible=!0:this.showScoreDialog.visible=!1},showScoreDialogConfirmOnClicked:function(){this.$router.push("/test_user/check_result")}}},l=u,d=s("2877"),c=Object(d["a"])(l,i,n,!1,null,null,null);e["default"]=c.exports},"84eb":function(t,e,s){"use strict";s.d(e,"f",(function(){return n})),s.d(e,"e",(function(){return o})),s.d(e,"b",(function(){return r})),s.d(e,"c",(function(){return a})),s.d(e,"d",(function(){return u})),s.d(e,"g",(function(){return l})),s.d(e,"a",(function(){return d}));var i=s("2fff");function n(t){return Object(i["a"])({url:"/exam/paper/user/"+t,method:"get"})}function o(t){return Object(i["a"])({url:"/admin/test/paper/"+t,method:"get"})}function r(t){return Object(i["a"])({url:"/admin/test/examByOption",method:"get",params:{testOptionId:t}})}function a(t){return Object(i["a"])({url:"/admin/test/question/searchByTestOption",method:"get",params:{testOptionId:t}})}function u(t,e){return Object(i["a"])({url:"/exam/"+t+"/user/"+e,method:"put"})}function l(t,e){return Object(i["a"])({url:"/exam/"+t+"/submit",method:"post",data:e})}function d(t){return Object(i["a"])({url:"/admin/test/exams",method:"delete",params:t})}}}]);